<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.ml.mldj.auth.mapper.SysUserMapper">


    <select id="querySysRoleByUserId" resultType="org.ml.mldj.model.system.entity.SysRole">
        select t2.*
        from sys_user_role t1,
             sys_role t2
        where t1.user_id = #{userId}
          and t1.role_id = t2.id
          and t2.is_deleted = 0;
    </select>
    <select id="queryMenuByRoles" resultType="org.ml.mldj.model.system.entity.SysMenu">
        SELECT DISTINCT m.*
        FROM sys_menu m
        INNER JOIN sys_role_menu rm ON m.id = rm.menu_id
        WHERE rm.role_id IN
        <foreach collection="roleIds" item="roleId" separator="," open="(" close=")">
            #{roleId}
        </foreach>
        AND m.status = 1
        AND m.is_deleted = 0
        ORDER BY m.parent_id, m.sort, m.id
    </select>
</mapper>
